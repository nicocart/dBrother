<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>结构化孔径报告解析</title>
    <link rel="stylesheet" href="/static/css/style.css" />
    <link rel="stylesheet" href="/static/css/structured.css" />
  </head>
  <body>
    <div class="page-container">
      <header class="page-header">
        <h1>结构化孔径报告解析通道</h1>
        <p class="subtitle">
          基于 pdfplumber 表格抽取的解析流程，可在未修改原有正则逻辑的情况下并行验证。
        </p>
        <nav class="nav-links">
          <a href="/">返回经典模式</a>
          <a href="/structured">结构化模式</a>
        </nav>
      </header>

      <main class="content">
        <section class="card">
          <h2>上传 PDF</h2>
          <p>
            该通道优先使用表格坐标抽取，无需拆散文本。文件解析完成后会自动清理临时文件。
          </p>
          <form id="structured-form">
            <label class="file-input">
              <span>选择 PDF 报告</span>
              <input
                id="structured-file"
                type="file"
                accept="application/pdf"
                required
              />
            </label>
            <button type="submit" class="primary">开始解析</button>
          </form>
          <div id="structured-status" class="status"></div>
        </section>

        <section class="card" id="structured-result-card" hidden>
          <h2>解析结果</h2>
          <div class="result-grid" id="structured-summary"></div>
          <details>
            <summary>NLDFT 详细数据 (前 200 行)</summary>
            <table>
              <thead>
                <tr>
                  <th>平均孔径 (nm)</th>
                  <th>孔积分体积 (cm³/g, STP)</th>
                </tr>
              </thead>
              <tbody id="structured-nldft"></tbody>
            </table>
          </details>
          <details>
            <summary>原始文本</summary>
            <pre id="structured-raw"></pre>
          </details>
        </section>

        <section class="card">
          <h2>快速说明</h2>
          <ul class="info-list">
            <li>使用 pdfplumber 的 <code>find_tables</code> + <code>extract</code> 直接读出表格结构。</li>
            <li>单点/多点 BET、总孔体积、平均孔径等指标来源于报表首个统计总表。</li>
            <li>NLDFT 数据按累积体积排序后计算 D10/D90、A 孔容及 0.5D / 1.5D 分布。</li>
            <li>最可几孔径直接读取 “最可几孔径” 字段，若缺失则返回空值。</li>
            <li>解析统计记录在 <code>structured_stats.json</code>，可用于对比正则路径的表现。</li>
          </ul>
        </section>
      </main>
    </div>
    <script src="/static/js/structured.js"></script>
  </body>
</html>
